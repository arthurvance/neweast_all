'use strict';

const createSharedAuthServiceFacade = ({
  login,
  sendOtp,
  loginWithOtp,
  platformOptions,
  tenantOptions,
  authorizeRoute,
  switchTenant,
  refresh,
  logout,
  changePassword,
  provisionPlatformUserByPhone,
  provisionTenantUserByPhone,
  findTenantUsershipByUserAndTenantId,
  findTenantUsershipByMembershipIdAndTenantId,
  listTenantUsers,
  updateTenantUserProfile,
  updateTenantUserStatus,
  getOrCreateUserIdentityByPhone,
  createOrganizationWithOwner,
  acquireOwnerTransferLock,
  releaseOwnerTransferLock,
  validateOwnerTransferRequest,
  executeOwnerTransferTakeover,
  createPlatformRoleCatalogEntry,
  updatePlatformRoleCatalogEntry,
  deletePlatformRoleCatalogEntry,
  listPlatformRoleCatalogEntries,
  findPlatformRoleCatalogEntryByRoleId,
  getSystemSensitiveConfig,
  upsertSystemSensitiveConfig,
  recordSystemSensitiveConfigAuditEvent,
  listPlatformRolePermissionGrants,
  replacePlatformRolePermissionGrants,
  listPlatformPermissionCatalog,
  listPlatformPermissionCatalogEntries,
  listTenantRolePermissionGrants,
  replaceTenantRolePermissionGrants,
  listTenantPermissionCatalog,
  listTenantPermissionCatalogEntries,
  listTenantUserRoleBindings,
  replaceTenantUserRoleBindings,
  updateOrganizationStatus,
  updatePlatformUserStatus,
  softDeleteUser,
  rollbackProvisionedUserIdentity,
  replacePlatformRolesAndSyncSnapshot,
  listAuditEvents,
  recordIdempotencyEvent,
  auditTrail,
  authStore,
  accessSessionCache,
  accessSessionCacheTtlMs,
  ownerTransferLocksByOrgId
} = {}) => {
  return {
    login,
    sendOtp,
    loginWithOtp,
    platformOptions,
    tenantOptions,
    authorizeRoute,
    switchTenant,
    refresh,
    logout,
    changePassword,
    provisionPlatformUserByPhone,
    provisionTenantUserByPhone,
    findTenantUsershipByUserAndTenantId,
    findTenantUsershipByMembershipIdAndTenantId,
    listTenantUsers,
    updateTenantUserProfile,
    updateTenantUserStatus,
    getOrCreateUserIdentityByPhone,
    createOrganizationWithOwner,
    acquireOwnerTransferLock,
    releaseOwnerTransferLock,
    validateOwnerTransferRequest,
    executeOwnerTransferTakeover,
    createPlatformRoleCatalogEntry,
    updatePlatformRoleCatalogEntry,
    deletePlatformRoleCatalogEntry,
    listPlatformRoleCatalogEntries,
    findPlatformRoleCatalogEntryByRoleId,
    getSystemSensitiveConfig,
    upsertSystemSensitiveConfig,
    recordSystemSensitiveConfigAuditEvent,
    listPlatformRolePermissionGrants,
    replacePlatformRolePermissionGrants,
    listPlatformPermissionCatalog,
    listPlatformPermissionCatalogEntries,
    listTenantRolePermissionGrants,
    replaceTenantRolePermissionGrants,
    listTenantPermissionCatalog,
    listTenantPermissionCatalogEntries,
    listTenantUserRoleBindings,
    replaceTenantUserRoleBindings,
    updateOrganizationStatus,
    updatePlatformUserStatus,
    softDeleteUser,
    rollbackProvisionedUserIdentity,
    replacePlatformRolesAndSyncSnapshot,
    listAuditEvents,
    recordIdempotencyEvent,
    // Test support
    _internals: {
      auditTrail,
      authStore,
      accessSessionCache,
      accessSessionCacheTtlMs,
      ownerTransferLocksByOrgId
    }
  };
};

module.exports = {
  createSharedAuthServiceFacade
};
