---
workflowType: 'prd'
workflow: 'edit'
date: '2026-02-11'
documentCounts:
  briefCount: 0
  researchCount: 0
  brainstormingCount: 1
  projectDocsCount: 23
projectClassification: 'greenfield'
facilitationContext:
  projectType: '0-1 SaaS'
  focus: 'foundation-first'
  qualityBar: 'current best practices; flag gaps and provide recommendations'
classification:
  projectType: saas_b2b
  domain: general
  complexity: medium
  projectContext: greenfield
inputDocuments:
  - '_bmad-output/planning-artifacts/prd-appendix-legacy-inputs.md'
stepsCompleted:
  - 'edit-prd'
  - 'validate-prd'
  - 'post-validation-optimization'
lastEdited: '2026-02-11T02:57:23Z'

# Product Requirements Document - neweast

**Author:** 老大
**Date:** 2026-02-10

## Executive Summary

### Product Vision

neweast 的 MVP 目标是交付一套可上线的多租户双域 RBAC 底座，确保平台治理（platform）与组织治理（tenant）边界清晰、行为一致、可审计、可恢复。

### Target Users

- 平台管理员：负责组织开通、平台成员与平台角色治理、负责人变更。
- 组织负责人/组织管理员：负责组织成员、组织角色、组织权限树与日常治理。
- 组织成员：在授权边界内完成业务操作，获得稳定的一致体验。

### Core Problem

当前风险集中在三类：跨租户越权、负责人交接中断、权限变更与会话状态不一致。若不在底座层一次性收敛，将在后续业务层产生高成本返工。

### Differentiation

- 双主线并行：Org Governance 与 Platform Governance 独立建模、独立验收。
- 强一致安全：关键状态变化驱动会话收敛，越权拒绝语义统一。
- 可运营集成：同步 API + 异步事件双通道，契约门禁与恢复演练前置。

### Phase Objective

Phase 1（MVP）以“治理闭环 + 1 条真实外部集成”作为发布主线，满足 P0 场景、集成 DoD、观测与恢复基线后进入规模化扩展阶段。

## Success Criteria

### User Success

- 平台域与组织域全流程可稳定跑通：平台域完成组织创建、角色配置、人员配置；组织域负责人可正常登录并完成角色与人员配置。
- 平台域核心流程一次跑通率 >=95%。
- 组织域负责人首次登录成功率 >=98%。
- 从创建组织到组织可用（负责人可登录并完成首轮配置）P90 <= 30 分钟。
- 关键操作（创建组织、负责人变更、角色授权）失败率 <=1%。

### Business Success

- T+30：至少 3 个真实组织完成全流程上线并持续使用。
- T+90：至少 10 个组织上线，周活管理员 >=20。
- 持续使用定义：上线组织中 >=80% 在最近 7 天至少完成 1 次核心管理动作（组织/角色/成员变更之一）。
- 上线前 P0 条款验收通过率 100%。

### Technical Success

- P0 自动化场景通过率 100%（租户边界、负责人变更原子并发、幂等合同、refresh/replay）。
- 鉴权/越权 Sev-1 事故 0。
- 核心 API P95 <= 300ms（在核心 API 常规负载条件下统计）。
- 服务可用性 >=99.5%。
- 故障恢复 MTTR <= 30 分钟。
- P0 相关故障告警发现时长 MTTD <= 5 分钟。

### Measurable Outcomes

- 成功项全部具备时间窗、阈值、验收口径。
- 指标直接绑定产品差异化：多租户双域 RBAC 底座的安全一致性与可运营性。

### Traceability Mapping (Success -> Journey)

| Success Criterion | Primary Journey Coverage | Measurement Method |
|---|---|---|
| 平台域核心流程一次跑通率 >=95% | Journey 1 / Journey 2 | 平台域端到端回归报告（日） |
| 组织负责人首次登录成功率 >=98% | Journey 1 / Journey 3 | 登录漏斗与错误码分布（日） |
| 创建组织到组织可用 P90 <= 30 分钟 | Journey 1 | 组织创建与负责人首登链路时延（按周） |
| 关键操作失败率 <=1% | Journey 1 / 2 / 4 / 5 | 关键写操作失败率监控（5 分钟窗口） |
| P0 自动化通过率 100% | Journey 1-5 | 发布门禁报告（每次发布） |
| Sev-1 鉴权/越权事故 0 | Journey 2 / 3 / 5 | 安全告警与事故台账（月） |
| MTTR <= 30 分钟、MTTD <= 5 分钟 | Journey 6（运维治理） | 监控告警系统 + 演练复盘（每次事件） |

## Product Scope

### MVP - Minimum Viable Product

- 认证与会话（密码/验证码登录、刷新、登出、改密）。
- 平台域：组织/角色/用户治理 + 负责人变更。
- 组织域：成员/角色治理 + 权限树分配。
- P0 四项闭环并验收通过。
- 最小运营能力：错误码治理、基础告警、审计链路。

### Growth Features (Post-MVP)

- 审计治理增强、灾备增强、运营看板与告警分层、效率工具增强。

### Vision (Future)

- 演进为可运营、可审计、可扩展的企业级 SCRM 权限与组织治理平台。

## User Journeys

### Journey 1: 平台管理员 - 组织治理（Org Governance）

**Opening Scene**  
李敏是平台管理员，负责新组织从开通到可接管。她最在意的是：组织开了但负责人进不去，导致上线卡死。

**Rising Action**  
她在平台域创建组织并指定负责人手机号，检查组织状态与负责人状态是否一致。

**Climax**  
负责人可从组织入口成功登录并进入组织工作台，组织进入可运营状态。

**Resolution**  
组织开通从“人工盯盘”变成“标准化可复制流程”。

**Trigger**  
新组织上线、组织初始化、负责人调整请求。

**Success Check**
- 组织创建成功且状态正确。
- 负责人可正常登录组织入口并进入组织工作台。
- 平台侧看到的组织状态、负责人状态与组织域实际状态一致。

**Failure Path**
- 组织创建失败、负责人无法登录、状态不一致时，返回标准错误码并提供恢复动作。

**Audit / Metric**
- 审计：组织创建、负责人设置、负责人首登。
- 指标：组织开通成功率、组织可用时长（创建到负责人可接管）。

### Journey 2: 平台管理员 - 平台自身治理（Platform Governance）

**Opening Scene**  
李敏需要搭建平台自身权限体系，确保平台成员能做平台治理动作但不越域。

**Rising Action**  
她配置平台角色并在平台权限树上分配 `platform.*` 权限；随后新增平台成员并分配平台角色。

**Climax**  
新增平台成员可正常进入平台入口，看到与角色匹配的平台菜单与按钮。

**Resolution**  
平台治理权限可控、可审计、可扩展，不依赖临时手工授权。

**Trigger**  
平台新增管理人员、平台职责调整、平台权限模型调整。

**Success Check**
- 新增平台成员可从平台入口正常登录。
- 登录后可执行已授权的平台域操作。
- 菜单正确性：平台域菜单按授权显示；组织域入口按授权可见或不可见。
- 平台角色权限仅命中 `platform.*`，不越域命中 `tenant.*`。

**Failure Path**
- 登录失败、授权不生效、菜单异常、越域访问时，系统返回统一错误码与修复路径。

**Audit / Metric**
- 审计：平台角色配置、平台权限树变更、平台成员创建与授权。
- 指标：平台成员首登成功率、平台授权生效率、越域拒绝率。

### Journey 3: 组织负责人主线成功旅程（组织接管落地）

**Opening Scene**  
王磊被任命为组织负责人，目标是在当天完成组织内角色与成员配置，确保团队可开始使用系统。

**Rising Action**  
他登录组织入口，创建组织角色并配置组织权限树，随后添加成员并分配角色。

**Climax**  
成员按角色看到不同菜单与按钮；权限内操作可执行，权限外操作被正确拒绝。

**Resolution**  
组织从“无人可管”进入“边界清晰、可持续治理”状态。

**Trigger**  
组织创建完成，负责人获得接管权限。

**Success Check**
- 组织角色授权仅命中 `tenant.*`。
- 角色变更可即时生效，成员权限表现与角色一致。

**Failure Path**
- 角色禁用、成员状态异常、权限漏配时，系统给出明确恢复路径。

**Audit / Metric**
- 审计：角色配置、成员授权、状态变更。
- 指标：负责人首登成功率、组织首轮配置完成率。

### Journey 4: 平台管理员高风险操作旅程（负责人变更）

**Opening Scene**  
业务高峰期需要更换组织负责人，目标是在不影响组织连续性的前提下完成交接。

**Rising Action**  
平台管理员发起负责人变更；后端按 `org_id` 串行化处理，并在单事务内完成 owner 变更、自动入组、自动授权。

**Climax**  
并发冲突返回明确错误；变更成功后权限与会话版本保持一致。

**Resolution**  
负责人交接安全、可追踪、可审计，避免组织“有名义负责人但无法接管”。

**Trigger**  
组织负责人调整请求。

**Success Check**
- 事务全成功或全回滚。
- 并发冲突语义明确。
- 新负责人可即时接管组织治理动作。

**Failure Path**
- 冲突重试或状态修复后重提，不出现半成功状态。

**Audit / Metric**
- 审计：before/after 变更详情、操作者与时间。
- 指标：负责人变更成功率、冲突率、恢复时长。

### Journey 5: 组织成员基础使用旅程（MVP 基础体验）

**Opening Scene**  
赵婷是普通组织成员，只希望快速完成权限内任务，不希望频繁依赖管理员。

**Rising Action**  
她登录后进入所属组织，系统按角色渲染菜单与按钮，并支持切换组织入口。

**Climax**  
权限内任务顺畅完成，权限外操作被清晰拒绝且有可执行提示。

**Resolution**  
成员体验可预期、边界清晰，减少误操作和重复沟通成本。

**Trigger**  
成员日常登录与业务操作。

**Success Check**
- 权限内操作可用。
- 权限外操作被正确拦截并反馈一致。
- 组织切换行为与身份状态一致。

**Failure Path**
- 入口错位或权限拒绝时，用户可按提示快速回到正确组织或联系管理员。

**Audit / Metric**
- 审计：登录、关键操作结果、拒绝原因分类。
- 指标：成员登录成功率、权限拒绝分布、关键路径完成率。

### Journey 6: 运维负责人 - 故障发现与恢复（Ops Governance）

**Opening Scene**  
陈晨是值班 SRE，目标是在权限相关故障发生时 5 分钟内发现、30 分钟内恢复，避免租户治理链路中断。

**Rising Action**  
监控触发“鉴权失败率异常”告警后，陈晨通过 `request_id` 与审计日志定位异常租户、异常角色变更与异常会话版本。

**Climax**  
执行标准 Runbook：隔离异常变更、回滚受影响策略、恢复关键链路并验证租户边界。

**Resolution**  
系统恢复到可运营状态，故障影响面明确，可复盘、可追责、可防复发。

**Trigger**  
鉴权失败率突增、越权拒绝率异常、负责人变更失败率异常。

**Success Check**
- 告警发现时长 `MTTD <= 5 分钟`。
- 故障恢复时长 `MTTR <= 30 分钟`。
- 恢复后 30 分钟内同类告警不再复发。

**Failure Path**
- 若 10 分钟内无法定位根因，自动升级至二线并启动降级策略；若 30 分钟内无法恢复，触发应急变更流程。

**Audit / Metric**
- 审计：告警触发、处置动作、回滚动作、恢复确认。
- 指标：MTTD、MTTR、重复告警率、应急升级次数。

### Journey Requirements Summary

- 核心能力按两条主线拆分并独立验收：
  - **Org Governance**：组织创建、负责人接管、组织可用性。
  - **Platform Governance**：平台角色、平台成员、平台权限树配置与生效。
- 双域权限强隔离：
  - 平台域使用 `platform.*`。
  - 组织域使用 `tenant.*`。
  - 平台与组织权限树独立配置、独立存储、独立生效。
- 平台域新增硬需求（MVP）：支持平台角色的权限树配置，并确保新平台成员可正常进入平台执行授权动作。
- 负向验收必须覆盖：
  - 未授予角色不得执行平台管理动作。
  - 仅平台成员且无组织关系时，不得进入组织工作台。
- 每条旅程都需落地为 Trigger、Success Check、Failure Path、Audit/Metric 的可验收条款。
- 非 MVP（Growth）：支持/审计专岗操作台与 API 集成方旅程。

### Journey -> FR 显式映射矩阵（新增）

| Journey | 目标能力 | 覆盖 FR IDs |
|---|---|---|
| Journey 1（平台管理员-组织治理） | 组织创建、负责人接管、组织可用 | FR10, FR11, FR12, FR25, FR32, FR34, FR35, FR64, FR65, FR76 |
| Journey 2（平台管理员-平台治理） | 平台用户/角色/权限树治理与生效 | FR13-FR18, FR26, FR27, FR31, FR49, FR50, FR72, FR73, FR75 |
| Journey 3（组织负责人接管） | 组织内角色/成员治理与权限落地 | FR19-FR24, FR25, FR30, FR33, FR35, FR65 |
| Journey 4（负责人变更高风险链路） | 并发安全、事务一致、可恢复 | FR12, FR25, FR35, FR54, FR71, FR76 |
| Journey 5（组织成员基础使用） | 登录、入口、组织切换、越权拒绝 | FR1-FR9, FR19, FR20, FR23, FR24, FR27-FR31, FR67-FR70, FR79 |
| Journey 6（运维治理） | 观测、审计、门禁、一致性恢复 | FR42-FR45, FR48, FR58, FR77-FR80 |

映射执行规则：
- 每个 FR 至少命中一条 Journey；若出现孤儿 FR，必须在评审前补齐映射。
- 每条 Journey 至少命中 1 组发布门禁用例，并在发布记录中可追踪到具体 FR ID。

## Domain-Specific Requirements

### Compliance & Regulatory

- MVP 阶段不做外部合规认证（SOC2/ISO/GDPR 等）。
- 以公司内部安全规范作为上线门槛。
- 关键管理与安全动作必须具备可追踪审计留痕。

### Technical Constraints

- 全链路 HTTPS。
- 敏感数据按策略加密存储。
- RBAC 强鉴权与双域隔离（`platform.*` / `tenant.*`）。
- 关键操作审计必达（登录、授权、负责人变更、敏感配置变更）。
- 会话强一致失效机制必须生效。
- 核心 API 性能目标：`P95 <= 300ms`。

### Integration Requirements

- MVP 存在外部系统通信需求（入站/出站都可能存在）。
- 采用“同步 API + 异步事件”双通道：
  - 同步 API 用于需要即时结果的命令类操作。
  - 异步事件/Webhook 用于状态通知与跨系统解耦。
- 鉴权基线：
  - 首选 OAuth2 Client Credentials。
  - 客户端认证优先 `private_key_jwt`。
  - 高安全场景可升级 `mTLS`。
  - Webhook 入站强制签名校验 + TLS。
- 可靠性基线：
  - 仅对可重试错误重试（`408/429/5xx`）。
  - 使用指数退避 + jitter。
  - 写操作采用幂等键 + 服务端去重。
  - 统一错误结构（Problem Details）。
  - 贯穿 `request_id` / `traceparent` 可观测链路。
- 架构预留未来扩展点（SSO/企微/钉钉），并与主认证授权链路解耦。
- 集成治理要求：
  - 采用集成分级（M0/M1/M2）管理接入范围和排期。
  - 定义 API/Event 版本策略（兼容期和下线策略）。
  - 入站通知需具备重放保护（签名 + 时间窗 + nonce）。
  - 异步链路需要 DLQ 和人工重放 Runbook。
  - 关键外部接口合同测试纳入发布门禁。
- 集成规格模板字段（每个外部系统接入都必须填写）：
  - 系统名 / 方向（入站、出站、双向）/ 协议（REST、Webhook、MQ）/ 鉴权方式。
  - 超时策略 / 重试策略 / 幂等策略 / 版本策略。
  - 审计字段 / 告警规则 / Runbook 链接。
- Integration Definition of Done（MVP-Ready）：
  - 接口契约已冻结并版本化。
  - 鉴权与签名验证通过。
  - 幂等与重试策略通过联调验证。
  - 关键外部接口合同测试通过并纳入发布门禁。
  - 监控告警与链路追踪可见（request_id / traceparent）。
  - 故障恢复演练通过（含 DLQ 消费与人工重放）。

### Risk Mitigations

- 跨租户越权风险：组织域只信任服务端有效租户上下文，禁止采信客户端租户标识。
- 权限误配风险：平台/组织权限树独立配置与独立生效，并覆盖负向回归用例。
- 负责人变更并发冲突风险：`org_id` 串行化 + 单事务提交 + 冲突错误语义。
- 会话失效不一致风险：会话版本与权限变更联动，确保即时收敛。

## SaaS B2B Specific Requirements

### Project-Type Overview

- 本项目为 B2B SaaS 权限底座，先完成可控、可审计、可扩展的多租户权限基础能力。
- 当前阶段以稳定交付优先，不做收费分层复杂度扩张。

### Technical Architecture Considerations

- 架构必须支持双域隔离（平台域 / 组织域）与强一致鉴权。
- 平台治理与组织治理分离建模、分离授权、分离验收。
- 集成架构按“内外部均可能接入”设计，以契约驱动与分期治理控制风险。

### Tenant Model

- 组织即租户，租户数据与权限边界强隔离。
- 组织域请求仅信任服务端有效租户上下文，禁止客户端租户透传主导鉴权。
- 负责人接管链路（变更、入组、授权）必须事务一致。

### RBAC Matrix

- 平台域权限：`platform.*`。
- 组织域权限：`tenant.*`。
- 平台角色权限树与组织角色权限树独立配置、独立存储、独立生效。
- 负向约束：
  - 平台成员未授予对应角色时，禁止访问平台管理动作。
  - 仅平台成员身份（无组织成员关系）不得进入组织工作台。

### Subscription Tiers

- MVP 采用单一版本（无计费分层、无套餐开关）。
- 分层能力作为 Growth 预留，不进入本期交付范围。

### Integration List

- 当前外部系统清单未冻结，采用“内外兼容 + 分期落地”策略。
- 内部集成与外部集成都纳入统一集成规格模板和 Integration DoD。
- 外部系统接入前必须完成契约评审并冻结版本策略。
- Integration Freeze Gate：
  - 在进入开发冲刺前，必须冻结首批外部系统名单、方向、优先级。
- 未冻结期间策略：
  - 先完成模拟外部系统合同测试桩（mock contract provider）验证契约和错误语义。
- 冻结后发布前置条件：
  - 必须补齐真实外部对接回归，作为发布门禁之一。

### Compliance Requirements

- 不做外部认证型合规目标（本期）。
- 上线门槛统一为：
  - 内部安全评审通过。
  - P0 用例通过率 100%。
  - Integration DoD 全量通过。

### Implementation Considerations

- 跳过 `cli_interface`、`mobile_first`（按项目类型配置不适用）。
- 外部系统未定阶段，先固化“接入规范与门槛”，后冻结“系统名单与优先级”。

## Project Scoping & Phased Development

### MVP Strategy & Philosophy

**MVP Approach:** 问题解决型 MVP（治理闭环）+ 集成可行性 MVP（至少 1 条真实外部集成打通）  
**Resource Requirements:** AI-first 交付模式（自动化产出为主），并保留最小人工治理责任：
- 业务决策 Owner（需求与优先级最终拍板）
- 技术签核 Owner（安全、架构、上线门禁签核）

### MVP Feature Set (Phase 1)

**Core User Journeys Supported:**
- Journey 1（平台管理员 - 组织治理）
- Journey 2（平台管理员 - 平台自身治理）
- Journey 3（组织负责人接管）
- Journey 4（负责人变更高风险链路）
- Journey 5（组织成员基础使用）

**Must-Have Capabilities:**
- 双域 RBAC 与权限树（平台/组织分离）
- 组织创建、负责人接管、负责人变更事务一致
- 会话强一致失效与越权防护
- P0 四项闭环并验收通过
- 至少 1 条真实外部集成链路（入站或出站）
- Integration DoD 全量通过（合同测试、追踪、重放恢复）

### Post-MVP Features

**Phase 2 (Post-MVP):**
- 审计专岗操作台
- 高级运营看板
- 外部集成扩展到首批 2-N 系统
- 集成治理强化（版本治理自动化、告警分层）

**Phase 3 (Expansion):**
- 套餐/分层能力（subscription tiers）
- 企业级生态能力（SSO 深化、组织协作治理增强）
- 更高阶策略自动化与运营优化

### Risk Mitigation Strategy

**Technical Risks**
- 风险：外部系统未完全冻结导致反复变更。  
  缓解：设置 Integration Freeze Gate；未冻结前只做契约与模拟桩，冻结后补真实对接回归。

**Market Risks**
- 风险：MVP 范围过大导致验证信号不清晰。  
  缓解：以治理闭环 + 1 条真实外部集成链路作为 Phase 1 验收主线，其余能力后置。

**Resource Risks**
- 风险：AI-first 开发下责任边界模糊。  
  缓解：强制双签核（业务 Owner + 技术 Owner），上线门槛不因 AI 模式降低。

### AI-First Engineering Guardrails

- 所有接口变更必须先通过契约 diff 审核。
- 关键权限路径必须具备负向测试覆盖。
- 发布策略必须采用灰度发布，不允许直接全量上线。
- MVP 出口必须具备可重复“一键回归”，至少覆盖：
  - P0 全量场景
  - 外部集成链路
  - 5 条用户旅程主路径

## Functional Requirements

### 统一模板说明（适用于 FR1-FR80）

- 模板字段：`需求陈述`、`验收口径`、`测量方法`、`追踪来源`、`优先级`、`发布波次`。
- 统一验收口径：
  - AC1 正向：对应功能用例通过率 `=100%`（发布门禁必过）。
  - AC2 负向：越权/非法状态拒绝率 `=100%`，并返回标准错误码。
  - AC3 审计：关键写操作审计写入率 `=100%`，可按 `request_id` 检索。
- 统一测量方法：CI 自动化回归 + 接口契约测试 + 审计抽样复核。
- 优先级定义：
  - `P0`：发布阻断能力，不满足即不可上线。
  - `P1`：MVP 稳定性/可运营增强，允许在首发后短周期补齐。
  - `P2`：效率与治理增强项，进入后续波次排期。
- 发布波次定义：
  - `Wave-1`：MVP 首发波次（P0 必须全部达标）。
  - `Wave-2`：稳定性与治理补强（P1 主要承载）。
  - `Wave-3`：优化与扩展（P2 主要承载）。

### FR 优先级与发布波次分配（新增）

| 优先级 | 发布波次 | FR IDs | 说明 |
|---|---|---|---|
| P0 | Wave-1 | FR1-FR35, FR49-FR54, FR62-FR64, FR67-FR72, FR76, FR79 | 核心治理闭环与安全一致性主链路 |
| P1 | Wave-2 | FR36-FR48, FR55, FR59-FR61, FR65-FR66, FR73-FR75, FR77-FR78, FR80 | 集成治理、审计观测、配置与可运营补强 |
| P2 | Wave-3 | FR56-FR58 | 高阶集成运营治理与报告增强 |

执行规则：
- 所有冲刺规划与发布门禁必须按上表引用 FR ID，不允许仅写能力名称。
- 如 FR 调整优先级，必须同步更新本表与发布计划，避免“文档优先级”与“实际交付”漂移。

### 认证与访问入口

- FR1
  - 需求陈述: 用户可以使用手机号+密码登录系统。
  - 验收口径: 采用统一模板 AC1/AC2/AC3，且三项全部通过。
  - 测量方法: 发布前执行自动化回归、权限负向回归与审计链路抽样。
  - 追踪来源: User Journeys + MVP Scope + Success Criteria。

- FR2
  - 需求陈述: 用户可以使用手机号+验证码登录系统。
  - 验收口径: 采用统一模板 AC1/AC2/AC3，且三项全部通过。
  - 测量方法: 发布前执行自动化回归、权限负向回归与审计链路抽样。
  - 追踪来源: User Journeys + MVP Scope + Success Criteria。

- FR3
  - 需求陈述: 用户可以刷新登录会话并保持访问连续性。
  - 验收口径: 采用统一模板 AC1/AC2/AC3，且三项全部通过。
  - 测量方法: 发布前执行自动化回归、权限负向回归与审计链路抽样。
  - 追踪来源: User Journeys + MVP Scope + Success Criteria。

- FR4
  - 需求陈述: 用户可以退出当前会话。
  - 验收口径: 采用统一模板 AC1/AC2/AC3，且三项全部通过。
  - 测量方法: 发布前执行自动化回归、权限负向回归与审计链路抽样。
  - 追踪来源: User Journeys + MVP Scope + Success Criteria。

- FR5
  - 需求陈述: 用户可以修改密码并在会话更新后重新登录。
  - 验收口径: 采用统一模板 AC1/AC2/AC3，且三项全部通过。
  - 测量方法: 发布前执行自动化回归、权限负向回归与审计链路抽样。
  - 追踪来源: User Journeys + MVP Scope + Success Criteria。

- FR6
  - 需求陈述: 系统可以根据登录入口识别访问域（平台域或组织域）。
  - 验收口径: 采用统一模板 AC1/AC2/AC3，且三项全部通过。
  - 测量方法: 发布前执行自动化回归、权限负向回归与审计链路抽样。
  - 追踪来源: User Journeys + MVP Scope + Success Criteria。

- FR7
  - 需求陈述: 多组织用户可以在登录后选择目标组织再进入工作台。
  - 验收口径: 采用统一模板 AC1/AC2/AC3，且三项全部通过。
  - 测量方法: 发布前执行自动化回归、权限负向回归与审计链路抽样。
  - 追踪来源: User Journeys + MVP Scope + Success Criteria。

- FR8
  - 需求陈述: 组织用户可以在会话内切换组织。
  - 验收口径: 采用统一模板 AC1/AC2/AC3，且三项全部通过。
  - 测量方法: 发布前执行自动化回归、权限负向回归与审计链路抽样。
  - 追踪来源: User Journeys + MVP Scope + Success Criteria。

- FR9
  - 需求陈述: 系统可以在用户无有效域权限时拒绝进入对应域，并返回错误码 `AUTH-403-NO-DOMAIN` 与标准提示文案。
  - 验收口径: 采用统一模板 AC1/AC2/AC3，且三项全部通过。
  - 测量方法: 发布前执行自动化回归、权限负向回归与审计链路抽样。
  - 追踪来源: User Journeys + MVP Scope + Success Criteria。

### 平台治理能力（Platform Governance）

- FR10
  - 需求陈述: 平台管理员可以创建组织并指定组织负责人。
  - 验收口径: 采用统一模板 AC1/AC2/AC3，且三项全部通过。
  - 测量方法: 发布前执行自动化回归、权限负向回归与审计链路抽样。
  - 追踪来源: User Journeys + MVP Scope + Success Criteria。

- FR11
  - 需求陈述: 平台管理员可以维护组织状态（启用/禁用）。
  - 验收口径: 采用统一模板 AC1/AC2/AC3，且三项全部通过。
  - 测量方法: 发布前执行自动化回归、权限负向回归与审计链路抽样。
  - 追踪来源: User Journeys + MVP Scope + Success Criteria。

- FR12
  - 需求陈述: 平台管理员可以变更组织负责人。
  - 验收口径: 采用统一模板 AC1/AC2/AC3，且三项全部通过。
  - 测量方法: 发布前执行自动化回归、权限负向回归与审计链路抽样。
  - 追踪来源: User Journeys + MVP Scope + Success Criteria。

- FR13
  - 需求陈述: 平台管理员可以创建与维护平台用户。
  - 验收口径: 采用统一模板 AC1/AC2/AC3，且三项全部通过。
  - 测量方法: 发布前执行自动化回归、权限负向回归与审计链路抽样。
  - 追踪来源: User Journeys + MVP Scope + Success Criteria。

- FR14
  - 需求陈述: 平台管理员可以维护平台用户状态。
  - 验收口径: 采用统一模板 AC1/AC2/AC3，且三项全部通过。
  - 测量方法: 发布前执行自动化回归、权限负向回归与审计链路抽样。
  - 追踪来源: User Journeys + MVP Scope + Success Criteria。

- FR15
  - 需求陈述: 平台管理员可以创建与维护平台角色（受保护系统角色除外编辑/删除）。
  - 验收口径: 采用统一模板 AC1/AC2/AC3，且三项全部通过。
  - 测量方法: 发布前执行自动化回归、权限负向回归与审计链路抽样。
  - 追踪来源: User Journeys + MVP Scope + Success Criteria。

- FR16
  - 需求陈述: 平台管理员可以配置平台角色权限树。
  - 验收口径: 采用统一模板 AC1/AC2/AC3，且三项全部通过。
  - 测量方法: 发布前执行自动化回归、权限负向回归与审计链路抽样。
  - 追踪来源: User Journeys + MVP Scope + Success Criteria。

- FR17
  - 需求陈述: 平台管理员可以向平台用户分配1 至 5 个平台角色。
  - 验收口径: 采用统一模板 AC1/AC2/AC3，且三项全部通过。
  - 测量方法: 发布前执行自动化回归、权限负向回归与审计链路抽样。
  - 追踪来源: User Journeys + MVP Scope + Success Criteria。

- FR18
  - 需求陈述: 新增平台成员在分配1 至 5 个平台角色后，可以进入平台并执行授权范围内操作。
  - 验收口径: 采用统一模板 AC1/AC2/AC3，且三项全部通过。
  - 测量方法: 发布前执行自动化回归、权限负向回归与审计链路抽样。
  - 追踪来源: User Journeys + MVP Scope + Success Criteria。

### 组织治理能力（Org Governance）

- FR19
  - 需求陈述: 组织负责人/组织管理员可以创建与维护组织成员。
  - 验收口径: 采用统一模板 AC1/AC2/AC3，且三项全部通过。
  - 测量方法: 发布前执行自动化回归、权限负向回归与审计链路抽样。
  - 追踪来源: User Journeys + MVP Scope + Success Criteria。

- FR20
  - 需求陈述: 组织负责人/组织管理员可以维护组织成员状态。
  - 验收口径: 采用统一模板 AC1/AC2/AC3，且三项全部通过。
  - 测量方法: 发布前执行自动化回归、权限负向回归与审计链路抽样。
  - 追踪来源: User Journeys + MVP Scope + Success Criteria。

- FR21
  - 需求陈述: 组织负责人/组织管理员可以创建与维护组织角色（受保护系统角色除外编辑/删除）。
  - 验收口径: 采用统一模板 AC1/AC2/AC3，且三项全部通过。
  - 测量方法: 发布前执行自动化回归、权限负向回归与审计链路抽样。
  - 追踪来源: User Journeys + MVP Scope + Success Criteria。

- FR22
  - 需求陈述: 组织负责人/组织管理员可以配置组织角色权限树。
  - 验收口径: 采用统一模板 AC1/AC2/AC3，且三项全部通过。
  - 测量方法: 发布前执行自动化回归、权限负向回归与审计链路抽样。
  - 追踪来源: User Journeys + MVP Scope + Success Criteria。

- FR23
  - 需求陈述: 组织负责人/组织管理员可以向组织成员分配1 至 5 个组织角色。
  - 验收口径: 采用统一模板 AC1/AC2/AC3，且三项全部通过。
  - 测量方法: 发布前执行自动化回归、权限负向回归与审计链路抽样。
  - 追踪来源: User Journeys + MVP Scope + Success Criteria。

- FR24
  - 需求陈述: 组织负责人/组织管理员可以维护成员的组织内资料（如显示名、部门）。
  - 验收口径: 采用统一模板 AC1/AC2/AC3，且三项全部通过。
  - 测量方法: 发布前执行自动化回归、权限负向回归与审计链路抽样。
  - 追踪来源: User Journeys + MVP Scope + Success Criteria。

- FR25
  - 需求陈述: 负责人变更后，新负责人可以立即完成组织治理接管。
  - 验收口径: 采用统一模板 AC1/AC2/AC3，且三项全部通过。
  - 测量方法: 发布前执行自动化回归、权限负向回归与审计链路抽样。
  - 追踪来源: User Journeys + MVP Scope + Success Criteria。

### 权限与授权执行

- FR26
  - 需求陈述: 系统可以维护平台域与组织域独立的权限命名空间与授权边界。
  - 验收口径: 采用统一模板 AC1/AC2/AC3，且三项全部通过。
  - 测量方法: 发布前执行自动化回归、权限负向回归与审计链路抽样。
  - 追踪来源: User Journeys + MVP Scope + Success Criteria。

- FR27
  - 需求陈述: 系统可以按有效权限控制菜单、按钮与受保护操作的可访问性。
  - 验收口径: 采用统一模板 AC1/AC2/AC3，且三项全部通过。
  - 测量方法: 发布前执行自动化回归、权限负向回归与审计链路抽样。
  - 追踪来源: User Journeys + MVP Scope + Success Criteria。

- FR28
  - 需求陈述: 系统可以对未授权访问执行一致性拒绝。
  - 验收口径: 采用统一模板 AC1/AC2/AC3，且三项全部通过。
  - 测量方法: 发布前执行自动化回归、权限负向回归与审计链路抽样。
  - 追踪来源: User Journeys + MVP Scope + Success Criteria。

- FR29
  - 需求陈述: 系统可以在权限计算中排除禁用角色。
  - 验收口径: 采用统一模板 AC1/AC2/AC3，且三项全部通过。
  - 测量方法: 发布前执行自动化回归、权限负向回归与审计链路抽样。
  - 追踪来源: User Journeys + MVP Scope + Success Criteria。

- FR30
  - 需求陈述: 系统可以在角色或授权变更后即时反映最新访问结果。
  - 验收口径: 采用统一模板 AC1/AC2/AC3，且三项全部通过。
  - 测量方法: 发布前执行自动化回归、权限负向回归与审计链路抽样。
  - 追踪来源: User Journeys + MVP Scope + Success Criteria。

- FR31
  - 需求陈述: 系统可以阻止仅平台身份且无组织关系的用户进入组织工作台。
  - 验收口径: 采用统一模板 AC1/AC2/AC3，且三项全部通过。
  - 测量方法: 发布前执行自动化回归、权限负向回归与审计链路抽样。
  - 追踪来源: User Journeys + MVP Scope + Success Criteria。

### 成员与组织生命周期

- FR32
  - 需求陈述: 系统可以在组织新增成员时复用已存在全局用户身份。
  - 验收口径: 采用统一模板 AC1/AC2/AC3，且三项全部通过。
  - 测量方法: 发布前执行自动化回归、权限负向回归与审计链路抽样。
  - 追踪来源: User Journeys + MVP Scope + Success Criteria。

- FR33
  - 需求陈述: 系统可以为同一用户在不同组织维护独立成员关系与角色绑定。
  - 验收口径: 采用统一模板 AC1/AC2/AC3，且三项全部通过。
  - 测量方法: 发布前执行自动化回归、权限负向回归与审计链路抽样。
  - 追踪来源: User Journeys + MVP Scope + Success Criteria。

- FR34
  - 需求陈述: 系统可以在成员离组后支持后续重新入组并形成新的有效成员关系。
  - 验收口径: 采用统一模板 AC1/AC2/AC3，且三项全部通过。
  - 测量方法: 发布前执行自动化回归、权限负向回归与审计链路抽样。
  - 追踪来源: User Journeys + MVP Scope + Success Criteria。

- FR35
  - 需求陈述: 系统可以在组织负责人变更时自动完成必要的成员关系与角色关系补齐。
  - 验收口径: 采用统一模板 AC1/AC2/AC3，且三项全部通过。
  - 测量方法: 发布前执行自动化回归、权限负向回归与审计链路抽样。
  - 追踪来源: User Journeys + MVP Scope + Success Criteria。

### 外部集成与互操作

- FR36
  - 需求陈述: 系统可以支持入站与出站的外部系统通信能力。
  - 验收口径: 采用统一模板 AC1/AC2/AC3，且三项全部通过。
  - 测量方法: 发布前执行自动化回归、权限负向回归与审计链路抽样。
  - 追踪来源: User Journeys + MVP Scope + Success Criteria。

- FR37
  - 需求陈述: 授权操作者可以为外部系统维护集成规格信息（方向、协议、鉴权、策略等）。
  - 验收口径: 采用统一模板 AC1/AC2/AC3，且三项全部通过。
  - 测量方法: 发布前执行自动化回归、权限负向回归与审计链路抽样。
  - 追踪来源: User Journeys + MVP Scope + Success Criteria。

- FR38
  - 需求陈述: 系统可以按版本化集成契约（OpenAPI/Event）执行外部接口交互。
  - 验收口径: 采用统一模板 AC1/AC2/AC3，且三项全部通过。
  - 测量方法: 发布前执行自动化回归、权限负向回归与审计链路抽样。
  - 追踪来源: User Journeys + MVP Scope + Success Criteria。

- FR39
  - 需求陈述: 系统可以对集成失败执行重试、恢复与再处理闭环。
  - 验收口径: 采用统一模板 AC1/AC2/AC3，且三项全部通过。
  - 测量方法: 发布前执行自动化回归、权限负向回归与审计链路抽样。
  - 追踪来源: User Journeys + MVP Scope + Success Criteria。

- FR40
  - 需求陈述: 系统可以对外部接口能力执行版本兼容管理。
  - 验收口径: 采用统一模板 AC1/AC2/AC3，且三项全部通过。
  - 测量方法: 发布前执行自动化回归、权限负向回归与审计链路抽样。
  - 追踪来源: User Journeys + MVP Scope + Success Criteria。

- FR41
  - 需求陈述: 系统可以在外部集成变更前执行契约一致性校验。
  - 验收口径: 采用统一模板 AC1/AC2/AC3，且三项全部通过。
  - 测量方法: 发布前执行自动化回归、权限负向回归与审计链路抽样。
  - 追踪来源: User Journeys + MVP Scope + Success Criteria。

### 审计与可追踪性

- FR42
  - 需求陈述: 系统可以记录认证、授权变更、负责人变更、关键配置变更等审计事件。
  - 验收口径: 采用统一模板 AC1/AC2/AC3，且三项全部通过。
  - 测量方法: 发布前执行自动化回归、权限负向回归与审计链路抽样。
  - 追踪来源: User Journeys + MVP Scope + Success Criteria。

- FR43
  - 需求陈述: 授权操作者可以按平台域/组织域查询审计事件。
  - 验收口径: 采用统一模板 AC1/AC2/AC3，且三项全部通过。
  - 测量方法: 发布前执行自动化回归、权限负向回归与审计链路抽样。
  - 追踪来源: User Journeys + MVP Scope + Success Criteria。

- FR44
  - 需求陈述: 系统可以将关键业务操作与集成交互关联到可追踪请求标识。
  - 验收口径: 采用统一模板 AC1/AC2/AC3，且三项全部通过。
  - 测量方法: 发布前执行自动化回归、权限负向回归与审计链路抽样。
  - 追踪来源: User Journeys + MVP Scope + Success Criteria。

- FR45
  - 需求陈述: 系统可以保留关键变更的前后状态用于追责与排障。
  - 验收口径: 采用统一模板 AC1/AC2/AC3，且三项全部通过。
  - 测量方法: 发布前执行自动化回归、权限负向回归与审计链路抽样。
  - 追踪来源: User Journeys + MVP Scope + Success Criteria。

### 系统配置与治理控制

- FR46
  - 需求陈述: 授权操作者可以维护受控系统配置（如默认密码策略项）。
  - 验收口径: 采用统一模板 AC1/AC2/AC3，且三项全部通过。
  - 测量方法: 发布前执行自动化回归、权限负向回归与审计链路抽样。
  - 追踪来源: User Journeys + MVP Scope + Success Criteria。

- FR47
  - 需求陈述: 系统可以对受保护系统角色实施不可编辑/不可删除约束。
  - 验收口径: 采用统一模板 AC1/AC2/AC3，且三项全部通过。
  - 测量方法: 发布前执行自动化回归、权限负向回归与审计链路抽样。
  - 追踪来源: User Journeys + MVP Scope + Success Criteria。

- FR48
  - 需求陈述: 系统可以在发布前执行并输出关键能力回归结果（P0、集成链路、核心旅程）。
  - 验收口径: 采用统一模板 AC1/AC2/AC3，且三项全部通过。
  - 测量方法: 发布前执行自动化回归、权限负向回归与审计链路抽样。
  - 追踪来源: User Journeys + MVP Scope + Success Criteria。

### 安全一致性与发布门禁

- FR49
  - 需求陈述: 系统可以按平台域角色并集计算平台用户有效权限（不使用显式 deny）。
  - 验收口径: 采用统一模板 AC1/AC2/AC3，且三项全部通过。
  - 测量方法: 发布前执行自动化回归、权限负向回归与审计链路抽样。
  - 追踪来源: User Journeys + MVP Scope + Success Criteria。

- FR50
  - 需求陈述: 系统可以在角色状态变更后即时重算并生效用户有效权限。
  - 验收口径: 采用统一模板 AC1/AC2/AC3，且三项全部通过。
  - 测量方法: 发布前执行自动化回归、权限负向回归与审计链路抽样。
  - 追踪来源: User Journeys + MVP Scope + Success Criteria。

- FR51
  - 需求陈述: 系统可以仅基于服务端上下文确定组织域有效租户并拒绝伪造租户上下文。
  - 验收口径: 采用统一模板 AC1/AC2/AC3，且三项全部通过。
  - 测量方法: 发布前执行自动化回归、权限负向回归与审计链路抽样。
  - 追踪来源: User Journeys + MVP Scope + Success Criteria。

- FR52
  - 需求陈述: 系统可以对关键写接口执行幂等判定并返回一致结果。
  - 验收口径: 采用统一模板 AC1/AC2/AC3，且三项全部通过。
  - 测量方法: 发布前执行自动化回归、权限负向回归与审计链路抽样。
  - 追踪来源: User Journeys + MVP Scope + Success Criteria。

- FR53
  - 需求陈述: 系统可以识别并处置 refresh token 重放行为。
  - 验收口径: 采用统一模板 AC1/AC2/AC3，且三项全部通过。
  - 测量方法: 发布前执行自动化回归、权限负向回归与审计链路抽样。
  - 追踪来源: User Journeys + MVP Scope + Success Criteria。

- FR54
  - 需求陈述: 系统可以对负责人变更并发冲突返回可识别冲突结果并支持安全重试。
  - 验收口径: 采用统一模板 AC1/AC2/AC3，且三项全部通过。
  - 测量方法: 发布前执行自动化回归、权限负向回归与审计链路抽样。
  - 追踪来源: User Journeys + MVP Scope + Success Criteria。

- FR55
  - 需求陈述: 授权操作者可以管理外部集成生命周期状态。
  - 验收口径: 采用统一模板 AC1/AC2/AC3，且三项全部通过。
  - 测量方法: 发布前执行自动化回归、权限负向回归与审计链路抽样。
  - 追踪来源: User Journeys + MVP Scope + Success Criteria。

- FR56
  - 需求陈述: 授权操作者可以执行外部集成清单冻结与解冻。
  - 验收口径: 采用统一模板 AC1/AC2/AC3，且三项全部通过。
  - 测量方法: 发布前执行自动化回归、权限负向回归与审计链路抽样。
  - 追踪来源: User Journeys + MVP Scope + Success Criteria。

- FR57
  - 需求陈述: 系统可以记录并追踪集成契约版本变更历史。
  - 验收口径: 采用统一模板 AC1/AC2/AC3，且三项全部通过。
  - 测量方法: 发布前执行自动化回归、权限负向回归与审计链路抽样。
  - 追踪来源: User Journeys + MVP Scope + Success Criteria。

- FR58
  - 需求陈述: 系统可以执行发布前能力回归门禁并输出按能力分组的结果。
  - 验收口径: 采用统一模板 AC1/AC2/AC3，且三项全部通过。
  - 测量方法: 发布前执行自动化回归、权限负向回归与审计链路抽样。
  - 追踪来源: User Journeys + MVP Scope + Success Criteria。

- FR59
  - 需求陈述: 系统可以在创建不存在用户时按默认密码策略初始化账号，并仅保存密码哈希。
  - 验收口径: 采用统一模板 AC1/AC2/AC3，且三项全部通过。
  - 测量方法: 发布前执行自动化回归、权限负向回归与审计链路抽样。
  - 追踪来源: User Journeys + MVP Scope + Success Criteria。

- FR60
  - 需求陈述: 系统可以在将已存在手机号用户加入平台或组织时保持该用户密码不变。
  - 验收口径: 采用统一模板 AC1/AC2/AC3，且三项全部通过。
  - 测量方法: 发布前执行自动化回归、权限负向回归与审计链路抽样。
  - 追踪来源: User Journeys + MVP Scope + Success Criteria。

- FR61
  - 需求陈述: 系统可以支持新建用户首次登录不强制改密，并通过配置开关控制该策略。
  - 验收口径: 采用统一模板 AC1/AC2/AC3，且三项全部通过。
  - 测量方法: 发布前执行自动化回归、权限负向回归与审计链路抽样。
  - 追踪来源: User Journeys + MVP Scope + Success Criteria。

- FR62
  - 需求陈述: 系统可以对认证相关接口按手机号维度执行限流并在超限时拒绝请求。
  - 验收口径: 采用统一模板 AC1/AC2/AC3，且三项全部通过。
  - 测量方法: 发布前执行自动化回归、权限负向回归与审计链路抽样。
  - 追踪来源: User Journeys + MVP Scope + Success Criteria。

- FR63
  - 需求陈述: 系统可以对密码登录、验证码登录、验证码发送实施独立限流计数。
  - 验收口径: 采用统一模板 AC1/AC2/AC3，且三项全部通过。
  - 测量方法: 发布前执行自动化回归、权限负向回归与审计链路抽样。
  - 追踪来源: User Journeys + MVP Scope + Success Criteria。

- FR64
  - 需求陈述: 平台管理员可以在创建组织时提交初始管理员手机号；未提交时系统必须拒绝创建并返回标准错误码。
  - 验收口径: 采用统一模板 AC1/AC2/AC3，且三项全部通过。
  - 测量方法: 发布前执行自动化回归、权限负向回归与审计链路抽样。
  - 追踪来源: User Journeys + MVP Scope + Success Criteria。

- FR65
  - 需求陈述: 系统可以在负责人变更后确保新负责人具备组织治理所需最小权限，且旧负责人权限不自动移除。
  - 验收口径: 采用统一模板 AC1/AC2/AC3，且三项全部通过。
  - 测量方法: 发布前执行自动化回归、权限负向回归与审计链路抽样。
  - 追踪来源: User Journeys + MVP Scope + Success Criteria。

- FR66
  - 需求陈述: 系统可以将 `sys_admin` 角色定义为受保护角色，仅允许授权分配，不允许编辑或删除。
  - 验收口径: 采用统一模板 AC1/AC2/AC3，且三项全部通过。
  - 测量方法: 发布前执行自动化回归、权限负向回归与审计链路抽样。
  - 追踪来源: User Journeys + MVP Scope + Success Criteria。

- FR67
  - 需求陈述: 系统可以支持同一用户多会话并发，且 `logout` 仅撤销当前会话。
  - 验收口径: 采用统一模板 AC1/AC2/AC3，且三项全部通过。
  - 测量方法: 发布前执行自动化回归、权限负向回归与审计链路抽样。
  - 追踪来源: User Journeys + MVP Scope + Success Criteria。

- FR68
  - 需求陈述: 系统可以支持平台入口与组织入口并行访问，并确保两入口能力边界一致受控。
  - 验收口径: 采用统一模板 AC1/AC2/AC3，且三项全部通过。
  - 测量方法: 发布前执行自动化回归、权限负向回归与审计链路抽样。
  - 追踪来源: User Journeys + MVP Scope + Success Criteria。

- FR69
  - 需求陈述: 系统可以在关键写接口支持幂等请求语义，并对重复请求返回一致结果。
  - 验收口径: 采用统一模板 AC1/AC2/AC3，且三项全部通过。
  - 测量方法: 发布前执行自动化回归、权限负向回归与审计链路抽样。
  - 追踪来源: User Journeys + MVP Scope + Success Criteria。

- FR70
  - 需求陈述: 系统可以在组织域鉴权中使用服务端确认的有效租户上下文进行最终访问判定。
  - 验收口径: 采用统一模板 AC1/AC2/AC3，且三项全部通过。
  - 测量方法: 发布前执行自动化回归、权限负向回归与审计链路抽样。
  - 追踪来源: User Journeys + MVP Scope + Success Criteria。

- FR71
  - 需求陈述: 系统可以在负责人变更并发场景下返回可识别冲突结果，并支持安全重试。
  - 验收口径: 采用统一模板 AC1/AC2/AC3，且三项全部通过。
  - 测量方法: 发布前执行自动化回归、权限负向回归与审计链路抽样。
  - 追踪来源: User Journeys + MVP Scope + Success Criteria。

- FR72
  - 需求陈述: 系统可以要求每个受保护接口声明权限标识，缺失声明时拒绝发布与运行。
  - 验收口径: 采用统一模板 AC1/AC2/AC3，且三项全部通过。
  - 测量方法: 发布前执行自动化回归、权限负向回归与审计链路抽样。
  - 追踪来源: User Journeys + MVP Scope + Success Criteria。

- FR73
  - 需求陈述: 系统可以维护统一权限清单并在启动时执行幂等同步。
  - 验收口径: 采用统一模板 AC1/AC2/AC3，且三项全部通过。
  - 测量方法: 发布前执行自动化回归、权限负向回归与审计链路抽样。
  - 追踪来源: User Journeys + MVP Scope + Success Criteria。

- FR74
  - 需求陈述: 系统可以在权限树保存时仅保留最终授权结果，并支持前端父子节点联动展示。
  - 验收口径: 采用统一模板 AC1/AC2/AC3，且三项全部通过。
  - 测量方法: 发布前执行自动化回归、权限负向回归与审计链路抽样。
  - 追踪来源: User Journeys + MVP Scope + Success Criteria。

- FR75
  - 需求陈述: 系统可以在角色状态变更为禁用后立即使其权限失效，并保留历史绑定记录。
  - 验收口径: 采用统一模板 AC1/AC2/AC3，且三项全部通过。
  - 测量方法: 发布前执行自动化回归、权限负向回归与审计链路抽样。
  - 追踪来源: User Journeys + MVP Scope + Success Criteria。

- FR76
  - 需求陈述: 系统可以在负责人变更前校验组织与新负责人状态，不满足条件时拒绝变更。
  - 验收口径: 采用统一模板 AC1/AC2/AC3，且三项全部通过。
  - 测量方法: 发布前执行自动化回归、权限负向回归与审计链路抽样。
  - 追踪来源: User Journeys + MVP Scope + Success Criteria。

- FR77
  - 需求陈述: 系统可以在组织软删除时同步失效成员、组织角色与角色绑定关系。
  - 验收口径: 采用统一模板 AC1/AC2/AC3，且三项全部通过。
  - 测量方法: 发布前执行自动化回归、权限负向回归与审计链路抽样。
  - 追踪来源: User Journeys + MVP Scope + Success Criteria。

- FR78
  - 需求陈述: 系统可以在用户软删除时撤销该用户全部 refresh token。
  - 验收口径: 采用统一模板 AC1/AC2/AC3，且三项全部通过。
  - 测量方法: 发布前执行自动化回归、权限负向回归与审计链路抽样。
  - 追踪来源: User Journeys + MVP Scope + Success Criteria。

- FR79
  - 需求陈述: 系统可以在权限或身份关键状态变化后使历史会话失效，并对失效会话返回未授权响应。
  - 验收口径: 采用统一模板 AC1/AC2/AC3，且三项全部通过。
  - 测量方法: 发布前执行自动化回归、权限负向回归与审计链路抽样。
  - 追踪来源: User Journeys + MVP Scope + Success Criteria。

- FR80
  - 需求陈述: 系统可以维护统一错误码体系，并提供可重试语义分层与前端动作映射。
  - 验收口径: 采用统一模板 AC1/AC2/AC3，且三项全部通过。
  - 测量方法: 发布前执行自动化回归、权限负向回归与审计链路抽样。
  - 追踪来源: User Journeys + MVP Scope + Success Criteria。

### 高风险 FR 专项发布门禁（Release Blocking）

| 风险能力 | 关联 FR | 必测门禁用例 | 通过标准 |
|---|---|---|---|
| 关键写幂等 | FR52, FR69 | 同一幂等键并发重放、乱序重放、超时重试 | 结果一致，且不产生重复写入 |
| 负责人变更并发 | FR54, FR71, FR76 | 同组织并发变更、冲突重试、状态前置校验 | 冲突可识别；成功链路全成功/全回滚 |
| 租户边界鉴权 | FR51, FR70 | 伪造租户上下文、跨租户资源访问、越权菜单/API 调用 | 越权拒绝率 100%，无误放行 |
| 权限声明防漏 | FR72, FR73 | 漏声明受保护接口、错误权限码、启动自检 | 漏声明接口不可发布/不可运行 |
| 删除级联一致性 | FR77, FR78, FR79 | 组织/用户/角色软删后残留关系检查、会话失效检查 | 无活跃脏关系；会话失效即时生效 |

门禁执行要求：
- 以上专项门禁全部为发布阻断项，任一失败即阻断发布。
- 每次发布必须产出专项门禁报告并归档到发布记录。

## Non-Functional Requirements

### 统一模板说明（适用于 NFR1-NFR38）

- 模板字段：`质量目标`、`量化指标`、`测量方法`、`验收证据`。
- 所有 NFR 必须满足：指标可量化、方法可执行、证据可归档。

### Performance

- NFR1
  - 质量目标: 核心 API 在常规核心负载下满足 P95 <= 300ms。
  - 量化指标: 核心 API 在常规负载下 `P95 <= 300ms`，持续达标率 `>=99%`（按 5 分钟窗口）。
  - 测量方法: APM + 压测平台（5 分钟窗口，7 天滚动统计）。
  - 验收证据: 性能压测报告、APM 导出截图、发布门禁记录。

- NFR2
  - 质量目标: 关键用户路径（登录、组织创建、角色授权、负责人变更）在交互侧保持可接受响应，不出现持续阻塞。
  - 量化指标: 登录、组织创建、角色授权、负责人变更四条关键路径 `P95 <= 2s`，`P99 <= 3s`。
  - 测量方法: APM + 压测平台（5 分钟窗口，7 天滚动统计）。
  - 验收证据: 性能压测报告、APM 导出截图、发布门禁记录。

- NFR3
  - 质量目标: 关键查询与列表能力在分页条件下保持稳定响应。
  - 量化指标: 关键列表/查询接口在 `pageSize=20` 条件下 `P95 <= 1.5s`。
  - 测量方法: APM + 压测平台（5 分钟窗口，7 天滚动统计）。
  - 验收证据: 性能压测报告、APM 导出截图、发布门禁记录。

### Security

- NFR4
  - 质量目标: 全链路通信必须使用 TLS。
  - 量化指标: 公网与内网服务间通信 `100%` 使用 `TLS1.2+`，弱加密套件命中数 `=0`。
  - 测量方法: 安全扫描 + 渗透测试 + 权限回归测试。
  - 验收证据: 安全测试报告、权限负向用例报告。

- NFR5
  - 质量目标: 敏感数据在存储与传输过程中必须受保护（如密码、令牌、敏感配置）。
  - 量化指标: 敏感字段（密码哈希、token、密钥配置）静态加密覆盖率 `=100%`，传输加密覆盖率 `=100%`。
  - 测量方法: 安全扫描 + 渗透测试 + 权限回归测试。
  - 验收证据: 安全测试报告、权限负向用例报告。

- NFR6
  - 质量目标: 平台域与组织域权限边界必须强隔离，不得出现越域授权生效。
  - 量化指标: 跨域越权测试集阻断率 `=100%`，生产越域授权事件 `=0`。
  - 测量方法: 安全扫描 + 渗透测试 + 权限回归测试。
  - 验收证据: 安全测试报告、权限负向用例报告。

- NFR7
  - 质量目标: 受保护接口默认拒绝未声明授权规则的访问。
  - 量化指标: 受保护接口权限声明覆盖率 `=100%`，漏声明接口发布阻断率 `=100%`。
  - 测量方法: 安全扫描 + 渗透测试 + 权限回归测试。
  - 验收证据: 安全测试报告、权限负向用例报告。

- NFR8
  - 质量目标: Refresh token 重放必须可识别并触发统一处置。
  - 量化指标: refresh token 重放检测识别率 `=100%`，处置时延 `<=1s`。
  - 测量方法: 安全扫描 + 渗透测试 + 权限回归测试。
  - 验收证据: 安全测试报告、权限负向用例报告。

### Reliability

- NFR9
  - 质量目标: MVP 期服务可用性目标 >= 99.5%。
  - 量化指标: MVP 期月度可用性 `>=99.5%`。
  - 测量方法: SRE 监控面板 + 演练记录 + 事务一致性测试。
  - 验收证据: 可用性报表、故障复盘、演练记录。

- NFR10
  - 质量目标: 故障恢复 MTTR <= 30 分钟。
  - 量化指标: 生产故障 MTTR `<=30 分钟`。
  - 测量方法: SRE 监控面板 + 演练记录 + 事务一致性测试。
  - 验收证据: 可用性报表、故障复盘、演练记录。

- NFR11
  - 质量目标: P0 相关故障告警发现时长 MTTD <= 5 分钟。
  - 量化指标: P0 故障 MTTD `<=5 分钟`。
  - 测量方法: SRE 监控面板 + 演练记录 + 事务一致性测试。
  - 验收证据: 可用性报表、故障复盘、演练记录。

- NFR12
  - 质量目标: 关键事务链路（负责人变更）必须满足全成功/全回滚一致性。
  - 量化指标: 负责人变更事务一致性通过率 `=100%`，半成功状态数 `=0`。
  - 测量方法: SRE 监控面板 + 演练记录 + 事务一致性测试。
  - 验收证据: 可用性报表、故障复盘、演练记录。

### Integration

- NFR13
  - 质量目标: 外部集成调用对可重试错误支持重试，并采用指数退避 + jitter。
  - 量化指标: 可重试错误重试成功率 `>=95%`，最大重试次数 `<=5`，退避使用指数 + jitter。
  - 测量方法: 契约测试 + 集成联调回归 + 发布门禁检查。
  - 验收证据: 契约测试报告、联调报告、门禁日志。

- NFR14
  - 质量目标: 写操作集成必须具备幂等保障与去重策略。
  - 量化指标: 写操作幂等去重命中正确率 `=100%`，重复写入导致脏数据数 `=0`。
  - 测量方法: 契约测试 + 集成联调回归 + 发布门禁检查。
  - 验收证据: 契约测试报告、联调报告、门禁日志。

- NFR15
  - 质量目标: 集成链路必须具备端到端可追踪标识（request_id / traceparent）。
  - 量化指标: 关键集成调用链路追踪字段覆盖率（`request_id`/`traceparent`）`>=99%`。
  - 测量方法: 契约测试 + 集成联调回归 + 发布门禁检查。
  - 验收证据: 契约测试报告、联调报告、门禁日志。

- NFR16
  - 质量目标: 外部接口变更必须通过契约一致性校验与版本治理流程。
  - 量化指标: 外部接口变更前契约一致性校验通过率 `=100%`，违规变更合入数 `=0`。
  - 测量方法: 契约测试 + 集成联调回归 + 发布门禁检查。
  - 验收证据: 契约测试报告、联调报告、门禁日志。

- NFR17
  - 质量目标: 外部集成上线必须满足 Integration DoD（合同测试、监控告警、恢复演练）。
  - 量化指标: 外部集成上线前 Integration DoD 条目通过率 `=100%`。
  - 测量方法: 契约测试 + 集成联调回归 + 发布门禁检查。
  - 验收证据: 契约测试报告、联调报告、门禁日志。

### Scalability

- NFR18
  - 质量目标: 架构支持从 MVP 向多组织规模增长时横向扩展，不以重写核心权限模型为前提。
  - 量化指标: 在 10x 目标规模压测下，核心鉴权与权限计算 `P95 <= 500ms`。
  - 测量方法: 容量压测（10x 场景）+ 关键路径探针监控。
  - 验收证据: 容量测试报告、可访问性评估报告。

- NFR19
  - 质量目标: 组织与成员规模增长时，权限计算与组织切换能力保持可用且可观测。
  - 量化指标: 组织切换在 1000 并发会话下 `P95 <= 1s`，错误率 `<0.1%`。
  - 测量方法: 容量压测（10x 场景）+ 关键路径探针监控。
  - 验收证据: 容量测试报告、可访问性评估报告。

### Accessibility

- NFR20
  - 质量目标: Web 端核心管理流程满足基础可访问性要求（键盘可达、语义化反馈、可识别错误提示）。
  - 量化指标: 核心管理流程满足 `WCAG 2.1 AA`，自动化检测通过率 `>=95%`。
  - 测量方法: 可访问性自动化扫描 + 人工走查。
  - 验收证据: 容量测试报告、可访问性评估报告。

- NFR21
  - 质量目标: 关键操作反馈不依赖单一视觉信号，提供文本可理解提示。
  - 量化指标: 关键操作文本反馈覆盖率 `=100%`，不依赖单一颜色/图标信号。
  - 测量方法: 可访问性自动化扫描 + 人工走查。
  - 验收证据: 容量测试报告、可访问性评估报告。

### Validation Evidence

- NFR22
  - 质量目标: 每个关键 NFR 都必须定义对应验证证据与验收归档（压测报告、安全测试、回归结果、演练记录）。
  - 量化指标: 关键 NFR 验证证据归档完整率 `=100%`。
  - 测量方法: 审计抽样 + 安全基线扫描 + 日志脱敏检测。
  - 验收证据: 审计日志样本、安全扫描报告。

- NFR23
  - 质量目标: 权限关键路径在 10x 目标规模增长场景需通过基线压测验证。
  - 量化指标: 权限关键路径在 10x 规模压测通过率 `=100%`，且越权误放行数 `=0`。
  - 测量方法: 审计抽样 + 安全基线扫描 + 日志脱敏检测。
  - 验收证据: 审计日志样本、安全扫描报告。

- NFR24
  - 质量目标: 默认密码配置必须以受保护配置形式存储，并通过环境密钥进行解密使用。
  - 量化指标: 默认密码配置密文存储覆盖率 `=100%`，解密仅允许环境密钥路径。
  - 测量方法: 审计抽样 + 安全基线扫描 + 日志脱敏检测。
  - 验收证据: 审计日志样本、安全扫描报告。

- NFR25
  - 质量目标: 系统不得存储、返回或记录明文密码，日志与审计中需对敏感凭据脱敏。
  - 量化指标: 明文密码存储/返回/日志暴露事件 `=0`。
  - 测量方法: 审计抽样 + 安全基线扫描 + 日志脱敏检测。
  - 验收证据: 审计日志样本、安全扫描报告。

- NFR26
  - 质量目标: 认证相关限流采用滑动窗口算法，限流维度为手机号。
  - 量化指标: 限流算法按手机号维度执行，统计误差 `<=1 请求/分钟`。
  - 测量方法: 认证服务指标 + 限流日志 + 会话一致性回归。
  - 验收证据: 认证回归报告、限流命中报表、会话测试报告。

- NFR27
  - 质量目标: 针对同一手机号，密码登录与验证码登录限流阈值为 1 分钟内最多 10 次（分别计数）；验证码发送实施 60 秒严格冷却期（发送后需等待 60 秒方可再次请求）。
  - 量化指标: 登录接口每手机号 1 分钟内阈值 `<=10 次`；验证码发送接口冷却期 `=60 秒`。
  - 测量方法: 认证服务指标 + 限流日志 + 会话一致性回归。
  - 验收证据: 认证回归报告、限流命中报表、会话测试报告。

- NFR28
  - 质量目标: 超限策略为立即拒绝本次请求，不设置冷却时间。
  - 量化指标: 超限请求拒绝响应时延 `<=100ms`，不进入冷却窗口。
  - 测量方法: 认证服务指标 + 限流日志 + 会话一致性回归。
  - 验收证据: 认证回归报告、限流命中报表、会话测试报告。

- NFR29
  - 质量目标: 验证码有效期固定为 15 分钟，并在过期后不可再用于登录。
  - 量化指标: 验证码有效期固定 `15 分钟`，过期后可用率 `=0%`。
  - 测量方法: 认证服务指标 + 限流日志 + 会话一致性回归。
  - 验收证据: 认证回归报告、限流命中报表、会话测试报告。

- NFR30
  - 质量目标: 验证码发送按钮倒计时必须基于服务端剩余时间恢复，避免刷新后失真。
  - 量化指标: 验证码倒计时刷新前后漂移 `<=3 秒`。
  - 测量方法: 认证服务指标 + 限流日志 + 会话一致性回归。
  - 验收证据: 认证回归报告、限流命中报表、会话测试报告。

- NFR31
  - 质量目标: 会话策略支持无限并发会话，`logout` 不影响其它会话。
  - 量化指标: 并发会话支持不少于 `5000` 活跃会话/用户；`logout` 仅影响当前会话准确率 `=100%`。
  - 测量方法: 认证服务指标 + 限流日志 + 会话一致性回归。
  - 验收证据: 认证回归报告、限流命中报表、会话测试报告。

- NFR32
  - 质量目标: 数据库存储统一 UTC，API 时间字段统一 UTC 返回。
  - 量化指标: 数据库时间字段 UTC 存储覆盖率 `=100%`，API UTC 返回覆盖率 `=100%`。
  - 测量方法: 接口契约测试 + 前端 E2E 展示测试。
  - 验收证据: API lint 报告、E2E 报告、接口覆盖清单。

- NFR33
  - 质量目标: 前端展示时间统一转换为 `Asia/Shanghai` 并使用统一格式输出。
  - 量化指标: 前端时间展示按 `Asia/Shanghai` 转换正确率 `=100%`。
  - 测量方法: 接口契约测试 + 前端 E2E 展示测试。
  - 验收证据: API lint 报告、E2E 报告、接口覆盖清单。

- NFR34
  - 质量目标: 密码规则最小约束为长度 `>= 6`，MVP 不强制复杂度、不限制历史复用、不要求新旧密码不同。
  - 量化指标: 密码策略校验通过率 `=100%`：最小长度 `>=6`。
  - 测量方法: 静态规则检查 + OpenAPI lint + CI 门禁。
  - 验收证据: API lint 报告、E2E 报告、接口覆盖清单。

- NFR35
  - 质量目标: 认证失败反馈采用统一外显语义（禁用状态可单独提示），验证码错误/过期/已使用对外统一文案。
  - 量化指标: 认证失败外显文案一致性覆盖率 `=100%`。
  - 测量方法: 静态规则检查 + OpenAPI lint + CI 门禁。
  - 验收证据: API lint 报告、E2E 报告、接口覆盖清单。

- NFR36
  - 质量目标: OpenAPI 必须完整覆盖请求字段、响应结构、枚举、分页、错误码与主要错误示例。
  - 量化指标: OpenAPI 覆盖率 `=100%`（字段、枚举、分页、错误码、示例）。
  - 测量方法: 静态规则检查 + OpenAPI lint + CI 门禁。
  - 验收证据: API lint 报告、E2E 报告、接口覆盖清单。

- NFR37
  - 质量目标: 上线最小可观测基线必须覆盖鉴权失败率、越权拒绝率、负责人变更失败率。
  - 量化指标: 上线观测基线三类指标（鉴权失败率/越权拒绝率/负责人变更失败率）仪表盘覆盖率 `=100%`。
  - 测量方法: 可观测平台巡检 + 灾备演练记录。
  - 验收证据: 监控仪表盘、灾备演练留档、上线检查单。

- NFR38
  - 质量目标: 上线前必须完成最小灾备基线（备份频率、恢复流程、至少一次恢复演练留档）。
  - 量化指标: 每季度至少完成 `1` 次恢复演练并通过，恢复演练通过率 `=100%`。
  - 测量方法: 可观测平台巡检 + 灾备演练记录。
  - 验收证据: 监控仪表盘、灾备演练留档、上线检查单。


## Consolidated Legacy Inputs (For Cleanup)

为保持主 PRD 只承载“可执行决策”，历史沉淀与扩展规范统一外置到：
- `_bmad-output/planning-artifacts/prd-appendix-legacy-inputs.md`

### 主文档保留索引

- 数据模型与删除语义：附录 `Data Model Baseline`、`Deletion*`。
- 字段字典与关系约束：附录 `Database Entity Field Catalog`、`Relation Constraint Catalog`。
- 前端契约与交互基线：附录 `Frontend*`。
- 交付与决策台账：附录 `Delivery Baseline`、`Decision Ledger`。

### 清理规则（执行）

1. 主 PRD 仅保留当前生效结论，不再承载历史讨论过程与大段模板。
2. 任何新增历史补充内容必须写入附录，并在本节追加索引，不直接膨胀主文档。
3. 评审与发布以主 PRD 为准；需要深挖细节时按索引跳转附录。
